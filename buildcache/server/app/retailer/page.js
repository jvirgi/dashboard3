(()=>{var e={};e.id=127,e.ids=[127],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10002:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(91437),r(37716),r(35866);var a=r(23191),s=r(88716),n=r(37922),l=r.n(n),o=r(95231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let d=["",{children:["retailer",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,91437)),"/workspace/voc-dashboard/app/retailer/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,37716)),"/workspace/voc-dashboard/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/workspace/voc-dashboard/app/retailer/page.tsx"],m="/retailer/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/retailer/page",pathname:"/retailer",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},39318:(e,t,r)=>{Promise.resolve().then(r.bind(r,75090))},75090:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(10326),s=r(17577),n=r(25040),l=r(10549),o=r(60387);function i({rows:e,cols:t,values:r,legendLabel:s="Avg Rating"}){let n=r.flat(),l=Math.min(...n),o=Math.max(...n);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"grid",style:{gridTemplateColumns:`120px repeat(${t.length}, minmax(0, 1fr))`},children:[a.jsx("div",{}),t.map(e=>a.jsx("div",{className:"text-xs text-slate-500 text-center pb-2",children:e},e)),e.map((e,s)=>(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"text-xs text-slate-600 pr-2 py-1 flex items-center",children:e},`row-${e}`),t.map((t,n)=>a.jsx("div",{className:"h-8 rounded-md m-0.5 border border-white shadow-[inset_0_1px_0_rgba(255,255,255,0.5)]",style:{backgroundColor:function(e){if(Number.isNaN(e))return"#e5e7eb";let t=(e-l)/(o-l||1);return`rgb(${Math.round(59+80*t)},${Math.round(130+-38*t)},${Math.round(246+0*t)})`}(r[s][n])},title:`${e} • ${t}: ${r[s][n].toFixed(2)}`},`${s}-${n}`))]}))]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-slate-500",children:[a.jsx("span",{children:s}),a.jsx("div",{className:"h-2 w-24 rounded",style:{background:"linear-gradient(90deg, #10b981, #8b5cf6)"}}),(0,a.jsxs)("span",{children:[l.toFixed(1),"–",o.toFixed(1)]})]})]})}var d=r(61521),c=r(80805),m=r(35047);function u(){let{retailers:e,dates:t,reviews:r}=n.m,u=(0,m.useRouter)(),[p,x]=(0,s.useState)(12),[h,g]=(0,s.useTransition)(),f=(0,s.useMemo)(()=>t.sort((e,t)=>e.date.getTime()-t.date.getTime()).slice(-p).map(e=>e.dateKey),[t,p]),v=(0,s.useMemo)(()=>r.filter(e=>f.includes(e.dateKey)),[r,f]),b=(0,s.useMemo)(()=>{let t=new Map;for(let r of e)t.set(r.retailerId,{name:r.name,avg:0,count:0});for(let e of v){let r=t.get(e.retailerId);r&&(r.avg+=e.rating,r.count+=1)}return Array.from(t.entries()).map(([e,t])=>({id:e,name:t.name,value:t.count?Number((t.avg/t.count).toFixed(2)):0}))},[v,e]),N=(0,s.useMemo)(()=>{let t=new Map;for(let r of e)t.set(r.retailerId,{name:r.name,count:0});for(let e of v){let r=t.get(e.retailerId);r&&(r.count+=1)}return Array.from(t.entries()).map(([e,t])=>({id:e,name:t.name,value:t.count}))},[v,e]);return(0,s.useMemo)(()=>{let t=f.map(e=>e),r=e.map(e=>e.name),a=new Map(e.map((e,t)=>[e.retailerId,t])),s=new Map(t.map((e,t)=>[e,t])),n=Array.from({length:r.length},()=>Array(t.length).fill(NaN));for(let e of v){let t=a.get(e.retailerId),r=s.get(e.dateKey);void 0!==t&&void 0!==r&&(Number.isNaN(n[t][r])&&(n[t][r]=0),n[t][r]=Number.isNaN(n[t][r])?e.rating:(n[t][r]+e.rating)/2)}return{rows:r,cols:t.map(e=>new Date(e+"-01").toLocaleDateString(void 0,{month:"short"})),values:n}},[v,f,e]),(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("div",{className:"rounded-2xl p-6 bg-white/60 backdrop-blur border border-slate-200 shadow-soft",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"font-semibold",children:"Retailer Comparison"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-sm text-slate-600",children:"Months:"}),a.jsx(d.l,{value:p,onChange:e=>g(()=>x(e))})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[(0,a.jsxs)(o.O,{className:"p-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Avg Rating by Retailer"}),h?a.jsx(c.O,{className:"h-80"}):a.jsx(l.f,{data:b,xKey:"name",barKey:"value",color:"#ef4444",onBarClick:e=>{u.push(`/?retailer=${encodeURIComponent(e)}`)}})]}),(0,a.jsxs)(o.O,{className:"p-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Review Volume by Retailer"}),h?a.jsx(c.O,{className:"h-80"}):a.jsx(l.f,{data:N,xKey:"name",barKey:"value",color:"#f59e0b",onBarClick:e=>{u.push(`/?retailer=${encodeURIComponent(e)}`)}})]})]}),(0,a.jsxs)(o.O,{className:"p-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Monthly Avg Rating Heatmap"}),h?a.jsx(c.O,{className:"h-72"}):a.jsx(i,{rows:e.map(e=>e.name),cols:f.map(e=>new Date(e+"-01").toLocaleDateString(void 0,{month:"short"})),values:(()=>{let t=e.length,r=f.length,a=Array.from({length:t},()=>Array(r).fill(NaN)),s=new Map(e.map((e,t)=>[e.retailerId,t])),n=new Map(f.map((e,t)=>[e,t]));for(let e of v){let t=s.get(e.retailerId),r=n.get(e.dateKey);void 0!==t&&void 0!==r&&(Number.isNaN(a[t][r])&&(a[t][r]=0),a[t][r]=Number.isNaN(a[t][r])?e.rating:(a[t][r]+e.rating)/2)}return a})()})]})]})}},61521:(e,t,r)=>{"use strict";r.d(t,{l:()=>s});var a=r(10326);function s({value:e,onChange:t}){return a.jsx("div",{className:"inline-flex rounded-full bg-slate-100 p-1 border border-slate-200",children:[6,12,18].map(r=>(0,a.jsxs)("button",{onClick:()=>t(r),className:`px-3 py-1.5 text-sm rounded-full transition ${e===r?"bg-white shadow-soft text-slate-900":"text-slate-600 hover:text-slate-900"}`,children:[r," mo"]},r))})}},80805:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});var a=r(10326);function s({className:e=""}){return a.jsx("div",{className:`skeleton rounded-md ${e}`})}},91437:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>o});var a=r(68570);let s=(0,a.createProxy)(String.raw`/workspace/voc-dashboard/app/retailer/page.tsx`),{__esModule:n,$$typeof:l}=s;s.default;let o=(0,a.createProxy)(String.raw`/workspace/voc-dashboard/app/retailer/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[589,883,191],()=>r(10002));module.exports=a})();