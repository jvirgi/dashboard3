(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{16336:function(e,t,a){Promise.resolve().then(a.bind(a,57300))},57300:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var r=a(57437),n=a(2265),o=a(60523),l=a(49128),s=a(25536);function i(e){let{rows:t,cols:a,values:n,legendLabel:o="Avg Rating"}=e,l=n.flat(),s=Math.min(...l),i=Math.max(...l);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"120px repeat(".concat(a.length,", minmax(0, 1fr))")},children:[(0,r.jsx)("div",{}),a.map(e=>(0,r.jsx)("div",{className:"text-xs text-slate-500 text-center pb-2",children:e},e)),t.map((e,t)=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-xs text-slate-600 pr-2 py-1 flex items-center",children:e},"row-".concat(e)),a.map((a,o)=>(0,r.jsx)("div",{className:"h-8 rounded-md m-0.5 border border-white shadow-[inset_0_1px_0_rgba(255,255,255,0.5)]",style:{backgroundColor:function(e){if(Number.isNaN(e))return"#e5e7eb";let t=(e-s)/(i-s||1);return"rgb(".concat(Math.round(59+80*t),",").concat(Math.round(130+-38*t),",").concat(Math.round(246+0*t),")")}(n[t][o])},title:"".concat(e," • ").concat(a,": ").concat(n[t][o].toFixed(2))},"".concat(t,"-").concat(o)))]}))]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-slate-500",children:[(0,r.jsx)("span",{children:o}),(0,r.jsx)("div",{className:"h-2 w-24 rounded",style:{background:"linear-gradient(90deg, #10b981, #8b5cf6)"}}),(0,r.jsxs)("span",{children:[s.toFixed(1),"–",i.toFixed(1)]})]})]})}var c=a(44525),d=a(94479),m=a(16463);function u(){let{retailers:e,dates:t,reviews:a}=o.m,u=(0,m.useRouter)(),[h,g]=(0,n.useState)(12),[f,p]=(0,n.useTransition)(),x=(0,n.useMemo)(()=>t.sort((e,t)=>e.date.getTime()-t.date.getTime()).slice(-h).map(e=>e.dateKey),[t,h]),v=(0,n.useMemo)(()=>a.filter(e=>x.includes(e.dateKey)),[a,x]),y=(0,n.useMemo)(()=>{let t=new Map;for(let a of e)t.set(a.retailerId,{name:a.name,avg:0,count:0});for(let e of v){let a=t.get(e.retailerId);a&&(a.avg+=e.rating,a.count+=1)}return Array.from(t.entries()).map(e=>{let[t,a]=e;return{id:t,name:a.name,value:a.count?Number((a.avg/a.count).toFixed(2)):0}})},[v,e]),N=(0,n.useMemo)(()=>{let t=new Map;for(let a of e)t.set(a.retailerId,{name:a.name,count:0});for(let e of v){let a=t.get(e.retailerId);a&&(a.count+=1)}return Array.from(t.entries()).map(e=>{let[t,a]=e;return{id:t,name:a.name,value:a.count}})},[v,e]);return(0,n.useMemo)(()=>{let t=x.map(e=>e),a=e.map(e=>e.name),r=new Map(e.map((e,t)=>[e.retailerId,t])),n=new Map(t.map((e,t)=>[e,t])),o=Array.from({length:a.length},()=>Array(t.length).fill(NaN));for(let e of v){let t=r.get(e.retailerId),a=n.get(e.dateKey);void 0!==t&&void 0!==a&&(Number.isNaN(o[t][a])&&(o[t][a]=0),o[t][a]=Number.isNaN(o[t][a])?e.rating:(o[t][a]+e.rating)/2)}return{rows:a,cols:t.map(e=>new Date(e+"-01").toLocaleDateString(void 0,{month:"short"})),values:o}},[v,x,e]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"rounded-2xl p-6 bg-white/60 backdrop-blur border border-slate-200 shadow-soft",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"Retailer Comparison"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-sm text-slate-600",children:"Months:"}),(0,r.jsx)(c.l,{value:h,onChange:e=>p(()=>g(e))})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[(0,r.jsxs)(s.O,{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Avg Rating by Retailer"}),f?(0,r.jsx)(d.O,{className:"h-80"}):(0,r.jsx)(l.f,{data:y,xKey:"name",barKey:"value",color:"#ef4444",onBarClick:e=>{u.push("/?retailer=".concat(encodeURIComponent(e)))}})]}),(0,r.jsxs)(s.O,{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Review Volume by Retailer"}),f?(0,r.jsx)(d.O,{className:"h-80"}):(0,r.jsx)(l.f,{data:N,xKey:"name",barKey:"value",color:"#f59e0b",onBarClick:e=>{u.push("/?retailer=".concat(encodeURIComponent(e)))}})]})]}),(0,r.jsxs)(s.O,{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Monthly Avg Rating Heatmap"}),f?(0,r.jsx)(d.O,{className:"h-72"}):(0,r.jsx)(i,{rows:e.map(e=>e.name),cols:x.map(e=>new Date(e+"-01").toLocaleDateString(void 0,{month:"short"})),values:(()=>{let t=e.length,a=x.length,r=Array.from({length:t},()=>Array(a).fill(NaN)),n=new Map(e.map((e,t)=>[e.retailerId,t])),o=new Map(x.map((e,t)=>[e,t]));for(let e of v){let t=n.get(e.retailerId),a=o.get(e.dateKey);void 0!==t&&void 0!==a&&(Number.isNaN(r[t][a])&&(r[t][a]=0),r[t][a]=Number.isNaN(r[t][a])?e.rating:(r[t][a]+e.rating)/2)}return r})()})]})]})}},25536:function(e,t,a){"use strict";a.d(t,{O:function(){return o}});var r=a(57437),n=a(27398);function o(e){let{children:t,className:a=""}=e;return(0,r.jsx)(n.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.35},whileHover:{y:-2},className:"card ".concat(a),children:t})}},44525:function(e,t,a){"use strict";a.d(t,{l:function(){return n}});var r=a(57437);function n(e){let{value:t,onChange:a}=e;return(0,r.jsx)("div",{className:"inline-flex rounded-full bg-slate-100 p-1 border border-slate-200",children:[6,12,18].map(e=>(0,r.jsxs)("button",{onClick:()=>a(e),className:"px-3 py-1.5 text-sm rounded-full transition ".concat(t===e?"bg-white shadow-soft text-slate-900":"text-slate-600 hover:text-slate-900"),children:[e," mo"]},e))})}},94479:function(e,t,a){"use strict";a.d(t,{O:function(){return n}});var r=a(57437);function n(e){let{className:t=""}=e;return(0,r.jsx)("div",{className:"skeleton rounded-md ".concat(t)})}},49128:function(e,t,a){"use strict";a.d(t,{f:function(){return g}});var r=a(57437),n=a(35231),o=a(25974),l=a(54142),s=a(2842),i=a(9542),c=a(85475),d=a(20153),m=a(45745),u=a(78703);function h(e){let{active:t,payload:a,label:n}=e;if(!t||!(null==a?void 0:a.length))return null;let[o]=a;return(0,r.jsxs)("div",{className:"rounded-lg border bg-white/95 p-3 shadow-soft",children:[(0,r.jsx)("div",{className:"text-xs text-slate-500",children:n}),(0,r.jsxs)("div",{className:"mt-1",children:[null==o?void 0:o.name,": ",(0,r.jsx)("span",{className:"font-medium",children:null==o?void 0:o.value})]})]})}function g(e){let{data:t,xKey:a,barKey:g,color:f="#3b82f6",onBarClick:p}=e,x=g.replace(/^[a-z]/,e=>e.toUpperCase()),v="grad-".concat(g.replace(/[^a-z0-9]/gi,""));return(0,r.jsx)("div",{className:"h-80",children:(0,r.jsx)(n.h,{width:"100%",height:"100%",children:(0,r.jsxs)(o.v,{data:t,margin:{top:10,right:10,left:0,bottom:40},children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:v,x1:"0",x2:"0",y1:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:f,stopOpacity:.9}),(0,r.jsx)("stop",{offset:"100%",stopColor:f,stopOpacity:.3})]})}),(0,r.jsx)(l.q,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,r.jsx)(s.K,{dataKey:a,tick:{fontSize:12},interval:0,angle:-20,textAnchor:"end",height:50}),(0,r.jsx)(i.B,{tick:{fontSize:12}}),(0,r.jsx)(c.u,{content:(0,r.jsx)(h,{})}),(0,r.jsx)(d.D,{}),(0,r.jsx)(m.$,{dataKey:g,fill:"url(#".concat(v,")"),radius:[8,8,0,0],name:x,onClick:e=>null==p?void 0:p(null==e?void 0:e.name),cursor:p?"pointer":"default",children:(0,r.jsx)(u.e,{dataKey:g,position:"top",className:"fill-slate-600 text-[11px]"})})]})})})}},60523:function(e,t,a){"use strict";let r;function n(e,t){return t[Math.floor(e()*t.length)]}function o(e,t,a){return Math.max(t,Math.min(a,e))}a.d(t,{m:function(){return j}});let l=(r=20240801,()=>(r=1103515245*r+12345>>>0)/4294967295),s=[{categoryId:"cat_beauty",name:"Beauty Care"},{categoryId:"cat_groom",name:"Grooming"},{categoryId:"cat_oral",name:"Oral Care"},{categoryId:"cat_house",name:"Household"}],i=[],c=[],d={cat_beauty:["Aurelia","Velura","Bloom\xe9","Chroma","Lustre"],cat_groom:["EdgeCraft","Stately","TrimX","UrbanMan"],cat_oral:["WhitenUp","FreshMint","EnamelPro","BrightSmile"],cat_house:["PureHome","Sparkle","CitrusWave","EcoClean"]},m=["Value","Mass","Premium"];for(let e of s)for(let t of d[e.categoryId]){let a="b_".concat(t.toLowerCase().replace(/[^a-z]/g,""));i.push({brandId:a,categoryId:e.categoryId,name:t});let r=6+Math.floor(4*l());for(let e=0;e<r;e++){let r="".concat(a,"_p").concat(e+1),n=m[Math.floor(l()*m.length)],o=["Serum","Cream","Gel","Foam","Brush","Kit","Pads","Strips","Cleanser"][e%9],s=[l()>.5?"Fragrance-free":"Fragranced",l()>.5?"Sensitive-skin":"All-skin",l()>.5?"Vegan":"Regular"];c.push({productId:r,brandId:a,name:"".concat(t," ").concat(o," ").concat(e+1),priceTier:n,attributes:s})}}let u=[{retailerId:"ret_amazon",name:"Amazon"},{retailerId:"ret_walmart",name:"Walmart"},{retailerId:"ret_target",name:"Target"},{retailerId:"ret_ulta",name:"Ulta Beauty"},{retailerId:"ret_cvs",name:"CVS Pharmacy"},{retailerId:"ret_walgreens",name:"Walgreens"}],h=(function(e){let t=[],a=new Date,r=new Date(a.getFullYear(),a.getMonth(),1);for(let e=17;e>=0;e--)t.push(new Date(r.getFullYear(),r.getMonth()-e,1));return t})(0).map(e=>{let t=e.getFullYear(),a=e.getMonth()+1;return{dateKey:"".concat(t,"-").concat(String(a).padStart(2,"0")),date:e,month:a,year:t,monthName:e.toLocaleString(void 0,{month:"short"})}}),g=[{themeId:"th_scent",name:"Scent"},{themeId:"th_texture",name:"Texture"},{themeId:"th_longevity",name:"Longevity"},{themeId:"th_value",name:"Value for Money"},{themeId:"th_packaging",name:"Packaging"},{themeId:"th_sensitivity",name:"Sensitivity"},{themeId:"th_whitening",name:"Whitening"},{themeId:"th_moisture",name:"Moisturizing"},{themeId:"th_irritation",name:"Irritation"},{themeId:"th_ease",name:"Ease of Use"}],f={cat_beauty:4.2,cat_groom:4,cat_oral:4.1,cat_house:4},p={Value:-.2,Mass:0,Premium:.2},x={ret_amazon:.5,ret_walmart:.2,ret_target:.15,ret_ulta:.07,ret_cvs:.05,ret_walgreens:.03},v={positive:["Exceeded my expectations","Absolutely love it","Great value","Works like a charm","Smells amazing","Gentle and effective","Noticeable results","Will repurchase","Highly recommend","Fantastic quality"],neutral:["Does the job","Decent for the price","Okay overall","Average performance","Nothing special"],negative:["Not worth it","Irritated my skin","Did not whiten as promised","Leaked in packaging","Too harsh","Unpleasant scent","Stopped working after a week","Poor value","Messy to use"]},y=[];c.map(e=>[e.productId,e]);let N=new Map(i.map(e=>[e.brandId,e])),b=[{region:"NA",country:["US","CA"]},{region:"EU",country:["UK","DE","FR","IT","ES"]},{region:"APAC",country:["JP","KR","AU","SG"]},{region:"LATAM",country:["BR","MX","AR","CL"]}];for(let e=0;e<6e3;e++){let t=n(l,c),a=N.get(t.brandId).categoryId,r=n(l,u),s=n(l,h);if(l()>(x[r.retailerId]||.1)+.15)continue;let i=o(f[a]+p[t.priceTier]+(l()-.5)*1,1,5),d=Math.round(i),m=o((i-1)/4+(l()-.5)*.05,0,1),j=Array.from(new Set(Array.from({length:1+Math.floor(2*l())},()=>n(l,g)).map(e=>e.themeId))),I=function(e,t,a){let r=n(e,a>=4?v.positive:a<=2?v.negative:v.neutral),o=t.length?" - ".concat(t[0].name.toLowerCase()," was a key factor."):"";return"".concat(r,".").concat(o)}(l,g.filter(e=>j.includes(e.themeId)),d),_=1+Math.floor(28*l()),w=new Date(s.year,s.month-1,_),M="".concat(w.getFullYear(),"-").concat(String(w.getMonth()+1).padStart(2,"0"),"-").concat(String(w.getDate()).padStart(2,"0")),k=n(l,b),C=n(l,k.country);y.push({reviewId:"r_".concat(e),productId:t.productId,retailerId:r.retailerId,dateKey:s.dateKey,rating:d,sentimentScore:Number(m.toFixed(3)),themeIds:j,text:I,helpfulVotes:Math.floor(20*l()),dateKeyDay:M,reviewDate:w,region:k.region,country:C})}let j={categories:s,brands:i,products:c,retailers:u,dates:h,themes:g,reviews:y}}},function(e){e.O(0,[863,971,23,744],function(){return e(e.s=16336)}),_N_E=e.O()}]);